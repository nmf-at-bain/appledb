function azfunc-teamswebhook ($teamsuri, $version, $build, $notes) {
    $notesLink = "[$notes]($notes)"

    $body = @{
        type = "message"
        attachments = @(
            @{
                contentType = "application/vnd.microsoft.card.adaptive"
                content = @{
                    type = "AdaptiveCard"
                    version = "1.4"
                    body = @(
                        @{
                            type = "container"
                            # Styles: "emphasis" (gray), "accent" (blue), "good" (green), "attention" (red)
                            style = "emphasis" 
                            items = @(
                                @{
                                    type = "TextBlock"
                                    text = "ðŸš¨ New iOS Version Released"
                                    weight = "Bolder"
                                    size = "ExtraLarge"
                                    color = "Attention"
                                    wrap = $true
                                }
                            )
                        },
                        @{
                            type = "container"
                            items = @(
                                @{
                                    type = "TextBlock"
                                    text = "Version: $version"
                                    size = "Large"
                                    weight = "Bolder"
                                    spacing = "Medium"
                                },
                                @{
                                    type = "FactSet"
                                    spacing = "Medium"
                                    facts = @(
                                        @{ title = "Build"; value = $build }
                                        @{ title = "Notes"; value = $notesLink }
                                    )
                                }
                            )
                        }
                    )
                    actions = @(
                        @{
                            type = "Action.OpenUrl"
                            title = "View Release Notes"
                            url = $notes
                        }
                    )
                }
            }
        )
    } | ConvertTo-Json -Depth 10

    Invoke-RestMethod -Method POST -Uri $teamsuri -ContentType "application/json" -Body $body
}
